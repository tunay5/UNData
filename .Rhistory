as
xml2::xml_find_all(xml2::xml_children(page, as))
xml2::find_all(page,as)
xml2::xml_find_all(page,as)
xml2::xml_children(xml2::xml_find_all(page,as))
xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
name
get(name)
paste0(name)
data <- 0
assign(name, data)
name
paste0(name)
get(name)
get(paste0(name))
name
get(name)[1]
get(name)[2] <- 1
name[2] <- 1
rm(name)
codelist[1] ->name
data <- 0
assign(name, data)
data
get(name)
get(ids)
data <- 0
assign(codelist[1], data)
data
codelist[1]
data <- 0
assign(as.character(codelist[1]),data)
codelist[1]
data
rm(CL_FREQ,data,name)
as.character(codelist[1])<-0
codelist[1] <- 0
codelist
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
codelist
codelist[1] <- c()
c()
as.character(codelist[1]) <- data.frame()
codelist[1] <- data.frame()
class(codelist[1])
name
name <- codelist[1]
data <- 0
data <- data.frame()
name <- data
name
data <- data.frame(name = 0)
data
data <- data.frame(name)
data
data <- data.frame(name = name)
data
name <- codelist[1]
data <- data.frame(name = name)
data
data <- data.frame(0)
data
colnames(data)[1] <- name
data
name <- data
name
name <- codelist[1]
data <- data.frame(0)
colnames(data)[1] <- name
data
name
data <- 1
data
data <- data.frame(0)
colnames(data)[1] <- name
xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
data <- data.frame(0)
colnames(data)[1] <- name
data <- data |> rbind(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
data
data <- data.frame()
colnames(data)[1] <- name
data
colnames(data) <- name
colnames(data)[0] <- name
data
data <- data |> rbind(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
data
data <- data.frame()
data <- data |> cbind(name = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
data <- data.frame(matrix(ncol = 0, nrow = 9))
data <- data |> cbind(name = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
data
name <- data
NAME
name
xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
codelist[1]
sg<- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
sg
rm(sg)
"asd" <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
asd
rm(asd)
as.character(codelist[i])
as.character(codelist[1])
as.character(codelist[1]) <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
data <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
name
rm(name)
name <- codelist[1]
assign(name, data)
name
get(name)
list(get(name))
list(get(name), get(name))
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == "DF_UNData_UNFCC")
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
assign(name, data)
}
list <- list(get(name))
}
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
assign(name, data)
}
list <- list(get(name))
}
data_structure("DF_UNData_UNFCC")
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
assign(name, data)
}
list <- list(get(name))
list
}
data_structure("DF_UNData_UNFCC")
data_flow()
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data[[i]] <- xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
}
list <- list(data)
list
}
data_structure("DF_UNData_UNFCC")
names(dataflow)
data.frame(codelist[1]=0)
data.frame(codelist[1])
data.frame(0)
data.frame()
data.frame(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
data.frame(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data.frame(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as)))
data.frame(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
data.frame(xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(col = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
}
list
}
data_structure("DF_UNDATA_WDI")
data_structure("DF_UNDATA_WDI")
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(col = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
}
list_1
}
data_structure("DF_UNDATA_WDI")
library(OECD)
get_datasets()
get_data_structure("QNA")
get_data_structure("DUR_D")
ls()
summary(data_structure("DF_UNDATA_WDI"))
list(list(1,2,3))
list(c("asd","asd"),c("sdf","sdf"))
asd<-data_structure("DF_UNDATA_WDI")
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(col = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))))
}
list_1
}
asd<-data_structure("DF_UNDATA_WDI")
asd[[1]]
asd[[2]]
asd[[3]]
asd[[3]][1]
asd[[3]][2]
asd[[3]]
asd[[4]]
asd[[1]]
xml2::xml_find_all(page)
xml2::xml_find_all(page,"//*[@id = 'CL_FREQ']")
xml2::xml_children(xml2::xml_find_all(page,"//*[@id = 'CL_FREQ']"))
xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page,"//*[@id = 'CL_FREQ']")),"id")
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(title = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))),
id = xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page, as)),"id"))
}
list_1
}
data_structure("DF_UNDATA_WDI")
asd<- data_structure("DF_UNDATA_WDI")
asd[[1]]
asd[[2]]
data_flow <- function(){
url_1 <- "https://data.un.org/ws/rest/dataflow/"
page_1<- xml2::read_xml(url_1)
ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//structure:Dataflow"),"id")
titles <- xml2::xml_text(xml2::xml_find_all(page_1, "//*[@xml:lang='en']"))
ref_ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//Ref"),"id")
agency_ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//Ref"),"agencyID")
titles <- titles[-10]
dataflow <- data.frame(titles, ids, ref_ids, agency_ids)
dataflow
}
data_flow()
data_flow()
data_flow()
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(title = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))),
id = xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page, as)),"id"))
}
assign(paste0("list_", dataflow), list_1, env = .GlobalEnv)
}
data_structure("NASEC_IDCFINA_A")
View(list_NASEC_IDCFINA_A)
list_NASEC_IDCFINA_A[[1]]
list_NASEC_IDCFINA_A[[1]][1]
View(list_NASEC_IDCFINA_A[[1]][1])
View(list_NASEC_IDCFINA_A[[1]])
View(list_NASEC_IDCFINA_A[[2]])
as <- c("awd","ws")
as[1]
as[1] <- data.frame()
as[1] <- data.frame(0)
as[1]
as <- c("awd","ws")
get(as[1])
get(as[1])
as[1]
get(as)
as
name <- as[1]
data <- data.frame(0)
data
assign(name, data)
awd
name
awd
as[1]
class(awd)
as.data.frame(as[1])
list <- c
list <- c("awsd", "asd")
name <- list[1]
data <- data.frame(0)
source("~/r_package/UN/R/main.R", echo=TRUE)
list <- c("awsd", "asd")
name <- list[1]
data <- data.frame(0)
assign(name, data)
as.data.frame(list[1])
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data <- data.frame(title = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))),
id = xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page, as)),"id"))
assign(name, data)
list_1[[i]] <- as.data.frame(codelist[i])
}
assign(paste0("list_", dataflow), list_1, env = .GlobalEnv)
}
data_flow <- function(){
url_1 <- "https://data.un.org/ws/rest/dataflow/"
page_1<- xml2::read_xml(url_1)
ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//structure:Dataflow"),"id")
titles <- xml2::xml_text(xml2::xml_find_all(page_1, "//*[@xml:lang='en']"))
ref_ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//Ref"),"id")
agency_ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//Ref"),"agencyID")
titles <- titles[-10]
dataflow <- data.frame(titles, ids, ref_ids, agency_ids)
dataflow
}
data_flow()
data_structure("DF_UNDATA_ENERGY")
View(list_DF_UNDATA_ENERGY)
as.data.frame(list[1])
as.data.frame(list[2])
View(data)
View(awsd)
awsd
get(as.character(list[1]))
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
data <- data.frame(title = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))),
id = xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page, as)),"id"))
assign(name, data)
list_1[[i]] <- as.data.frame(get(as.character(codelist[i])))
}
assign(paste0("list_", dataflow), list_1, env = .GlobalEnv)
}
data_structure("DF_UNDATA_ENERGY")
View(list_DF_UNDATA_ENERGY)
list_DF_UNDATA_ENERGY[[1]]
View(list_DF_UNDATA_ENERGY[[1]])
names(list_DF_UNDATA_ENERGY)
names(list_DF_UNDATA_ENERGY)[1]
names(list_DF_UNDATA_ENERGY)[1] <- "asd"
View(list_DF_UNDATA_ENERGY)
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(title = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))),
id = xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page, as)),"id"))
names(list_1)[i] <- name
}
assign(paste0("list_", dataflow), list_1, env = .GlobalEnv)
}
View(list_DF_UNDATA_ENERGY[[1]])
data_structure("DF_UNDATA_ENERGY")
View(list_DF_UNDATA_ENERGY)
data_flow()
data_flow()
list_DF_UNDATA_ENERGY[4]
data_structure("DF_UNDATA_WDI")
View(list_DF_UNDATA_WDI)
list_DF_UNDATA_WDI[1]
list_DF_UNDATA_WDI[2]
dataflow <- data_flow()
View(dataflow)
data_structure("SEEANRG")
View(list_SEEANRG)
list_SEEANRG[1]
list_SEEANRG[2]
list_SEEANRG[3]
list(list_SEEANRG)
summary(list_DF_UNDATA_ENERGY)
summary(list_SEEANRG)
data_structure <- function(dataflow){
data <- data_flow() |> dplyr::filter(ids == dataflow)
ref_id <- data[1,3]
agency_id <- data[1,4]
url <- paste0("https://data.un.org/ws/rest/datastructure/",agency_id,"/",ref_id,"/?references=children")
page <- xml2::read_xml(url)
codelist <- xml2::xml_attr(xml2::xml_find_all(page, "//structure:Codelist"),"id")
list_1 <- list()
for(i in 1:length(codelist)){
name <- codelist[i]
as <- paste0(paste("//*[@id = '", name, "'", sep = ""),"]")
list_1[[i]] <- data.frame(title = xml2::xml_text(xml2::xml_children(xml2::xml_find_all(page,as))),
id = xml2::xml_attr(xml2::xml_children(xml2::xml_find_all(page, as)),"id"))
names(list_1)[i] <- name
}
assign(paste0("list_", dataflow), list_1, env = .GlobalEnv)
print(summary(list_1))
}
data_structure("SEEANRG")
data_structure("SEEANRG")
data_structure("SEEANRG")
list_SEEANRG[1]
View(list_SEEANRG[1])
View(list_SEEANRG[[1]])
View(list_SEEANRG)
View(list_SEEANRG[[2]])
View(list_SEEANRG[[3]])
data_flow <- function(){
url_1 <- "https://data.un.org/ws/rest/dataflow/"
page_1<- xml2::read_xml(url_1)
ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//structure:Dataflow"),"id")
titles <- xml2::xml_text(xml2::xml_find_all(page_1, "//*[@xml:lang='en']"))
ref_ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//Ref"),"id")
agency_ids <- xml2::xml_attr(xml2::xml_find_all(page_1, "//Ref"),"agencyID")
titles <- titles[-10]
dataflow <- data.frame(titles, ids, ref_ids, agency_ids)
dataflow
}
dataflow <- data_flow()
View(dataflow)
library(devtools)
devtools::load_all(".")
devtools::load_all(".")
library(UN)
devtools::load_all(".")
library(UN)
data <- data_flow()
View(data)
data_structure("DF_UNDATA_WDI")
View(list_DF_UNDATA_WDI)
View(list_DF_UNDATA_WDI[[1]])
View(list_DF_UNDATA_WDI[[2]])
View(list_DF_UNDATA_WDI[[3]])
get_data(dataflow = "DF_UNDATA_WDI", filter = list(c("SERIES","ARM"),c("FREQ","A")))
data_structure("DF_UNData_UNFCC")
View(list_DF_UNData_UNFCC)
View(list_DF_UNData_UNFCC[[1]])
View(list_DF_UNData_UNFCC[[2]])
View(list_DF_UNData_UNFCC[[3]])
View(list_DF_UNData_UNFCC[[4]])
get_data(dataflow = "DF_UNData_UNFCC", filter = list(c("UNIT","Gg_CO2"),c("REF_AREA","AUS"),c("FREQ","A"),c("INDICATOR","EN_ATM_HFCE")))
